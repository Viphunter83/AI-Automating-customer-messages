# ‚úÖ –§–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º

**–ü—Ä–æ–µ–∫—Ç:** Neiromatrius  
**–î–∞—Ç–∞:** 8 –¥–µ–∫–∞–±—Ä—è 2025  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –¥–µ–ø–ª–æ—é

---

## üîç –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏

### ‚úÖ 1. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

**–¢–∏–ø –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:** –ü—Ä—è–º–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ PostgreSQL —á–µ—Ä–µ–∑ SQLAlchemy ORM

**–§–æ—Ä–º–∞—Ç DATABASE_URL:**
```bash
postgresql+asyncpg://postgres:password@db.xxxxx.supabase.co:5432/postgres
```

**–°—Ç–∞—Ç—É—Å:**
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç SQLAlchemy ORM –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ë–î
- ‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ asyncpg –¥—Ä–∞–π–≤–µ—Ä
- ‚úÖ –ù–ï –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Supabase REST API
- ‚úÖ –ú–∏–≥—Ä–∞—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –≤—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑ SQL Editor

**–§–∞–π–ª—ã:**
- ‚úÖ `database/migrations_supabase.sql` - –≥–æ—Ç–æ–≤ –∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é
- ‚úÖ `backend/app/database.py` - –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è –ø—Ä—è–º–æ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- ‚úÖ `backend/scripts/entrypoint.sh` - –º–∏–≥—Ä–∞—Ü–∏–∏ Alembic –æ—Ç–∫–ª—é—á–µ–Ω—ã (–≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –≤—Ä—É—á–Ω—É—é)

---

### ‚úÖ 2. Docker Compose —Ñ–∞–π–ª—ã

**Backend (`dokploy/docker-compose.backend.yml`):**
- ‚úÖ Build context: `./backend`
- ‚úÖ Container name: `neiromatrius-backend`
- ‚úÖ Port: `8000:8000`
- ‚úÖ Healthcheck: –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- ‚úÖ Network: `neiromatrius-network`
- ‚úÖ –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è: –≤—Å–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç `${VAR}` —Å–∏–Ω—Ç–∞–∫—Å–∏—Å

**Frontend (`dokploy/docker-compose.frontend.yml`):**
- ‚úÖ Build context: `./frontend`
- ‚úÖ Container name: `neiromatrius-frontend`
- ‚úÖ Port: `3000:3000`
- ‚úÖ Healthcheck: –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- ‚úÖ Network: `neiromatrius-network`
- ‚úÖ BACKEND_API_URL: `http://neiromatrius-backend:8000`

**Redis (`dokploy/docker-compose.redis.yml`):**
- ‚úÖ Image: `redis:7-alpine`
- ‚úÖ Container name: `neiromatrius-redis`
- ‚úÖ Port: `6379:6379`
- ‚úÖ Healthcheck: –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- ‚úÖ Network: `neiromatrius-network`
- ‚úÖ Volume: `redis_data` –¥–ª—è –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏

---

### ‚úÖ 3. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

**Backend (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ):**
- ‚úÖ `DATABASE_URL` - —Ñ–æ—Ä–º–∞—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π (`postgresql+asyncpg://...`)
- ‚úÖ `OPENAI_API_KEY` - —Ç—Ä–µ–±—É–µ—Ç—Å—è
- ‚úÖ `SECRET_KEY` - —Ç—Ä–µ–±—É–µ—Ç—Å—è (–º–∏–Ω–∏–º—É–º 32 —Å–∏–º–≤–æ–ª–∞)

**Backend (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ):**
- ‚úÖ `REDIS_URL` - –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
- ‚úÖ `TELEGRAM_BOT_TOKEN` - –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
- ‚úÖ `ALLOWED_ORIGINS` - –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è

**Frontend:**
- ‚úÖ `NEXT_PUBLIC_API_URL` - –æ–±—ã—á–Ω–æ `/api`
- ‚úÖ `BACKEND_API_URL` - –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π URL backend

---

### ‚úÖ 4. SQL –ú–∏–≥—Ä–∞—Ü–∏–∏

**–§–∞–π–ª:** `database/migrations_supabase.sql`

**–°–æ–¥–µ—Ä–∂–∏–º–æ–µ:**
- ‚úÖ 6 ENUM —Ç–∏–ø–æ–≤ —Å–æ–∑–¥–∞–Ω—ã
- ‚úÖ 9 —Ç–∞–±–ª–∏—Ü —Å–æ–∑–¥–∞–Ω—ã
- ‚úÖ –ò–Ω–¥–µ–∫—Å—ã —Å–æ–∑–¥–∞–Ω—ã
- ‚úÖ –§—É–Ω–∫—Ü–∏–∏ –∏ —Ç—Ä–∏–≥–≥–µ—Ä—ã —Å–æ–∑–¥–∞–Ω—ã
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –≤–∫–ª—é—á–µ–Ω—ã

**–°—Ç–∞—Ç—É—Å:** –ì–æ—Ç–æ–≤ –∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é –≤ Supabase SQL Editor

---

### ‚úÖ 5. –°–∫—Ä–∏–ø—Ç—ã –ø—Ä–æ–≤–µ—Ä–∫–∏

**–°–æ–∑–¥–∞–Ω–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã:**
- ‚úÖ `scripts/validate_config.py` - –≤–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- ‚úÖ `scripts/test_db_connection.py` - —Ç–µ—Å—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:**
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏: **–ü–†–û–ô–î–ï–ù–ê**
- ‚úÖ Docker Compose —Ñ–∞–π–ª—ã: **–ö–û–†–†–ï–ö–¢–ù–´**
- ‚úÖ SQL –º–∏–≥—Ä–∞—Ü–∏–∏: **–ü–†–û–í–ï–†–ï–ù–´**

---

## üìã –ß–µ–∫–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º

### –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞

- [x] SQL –º–∏–≥—Ä–∞—Ü–∏–∏ –≥–æ—Ç–æ–≤—ã (`database/migrations_supabase.sql`)
- [x] Docker Compose —Ñ–∞–π–ª—ã –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã
- [x] –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã
- [x] –°–∫—Ä–∏–ø—Ç—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ–∑–¥–∞–Ω—ã
- [x] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞

### –ü–µ—Ä–µ–¥ –ø—É—à–µ–º –≤ GitHub

- [ ] –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∑–∞–∫–æ–º–º–∏—á–µ–Ω—ã
- [ ] –ù–µ—Ç —Å–µ–∫—Ä–µ—Ç–æ–≤ –≤ –∫–æ–¥–µ
- [ ] `.gitignore` –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- [ ] –í–∞–ª–∏–¥–∞—Ü–∏—è –ø—Ä–æ–π–¥–µ–Ω–∞: `python3 scripts/validate_config.py`

### –í Supabase

- [ ] –í—ã–ø–æ–ª–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏: `database/migrations_supabase.sql`
- [ ] –ü–æ–ª—É—á–∏—Ç—å DATABASE_URL –∏–∑ Dashboard
- [ ] –û—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å DATABASE_URL (–¥–æ–±–∞–≤–∏—Ç—å `+asyncpg`)

### –í Dokploy

- [ ] –°–æ–∑–¥–∞—Ç—å Redis —Å–µ—Ä–≤–∏—Å (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
- [ ] –°–æ–∑–¥–∞—Ç—å Backend —Å–µ—Ä–≤–∏—Å
- [ ] –°–æ–∑–¥–∞—Ç—å Frontend —Å–µ—Ä–≤–∏—Å
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –¥–æ–º–µ–Ω—ã –∏ SSL
- [ ] –ó–∞–¥–µ–ø–ª–æ–∏—Ç—å –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã

---

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

1. **–¢–∏–ø –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:** –ü—Ä—è–º–æ–µ PostgreSQL –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ, –ù–ï REST API
2. **–ú–∏–≥—Ä–∞—Ü–∏–∏:** –í—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –≤—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑ Supabase SQL Editor
3. **–§–æ—Ä–º–∞—Ç DATABASE_URL:** –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ `postgresql+asyncpg://...`

### Redis

1. **–û–ø—Ü–∏–æ–Ω–∞–ª–µ–Ω:** –°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ Redis (in-memory cache)
2. **–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:** –î–ª—è production —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –∏–Ω—Å—Ç–∞–Ω—Å–∞–º–∏
3. **–†–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ—Ç—Å—è:** –ß–µ—Ä–µ–∑ Git –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω—ã–π Docker Compose —Å–µ—Ä–≤–∏—Å

### –°–µ—Ç—å Docker

1. **–í—Å–µ —Å–µ—Ä–≤–∏—Å—ã:** –î–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ —Å–µ—Ç–∏ `neiromatrius-network`
2. **–°–≤—è–∑—å:** –ü–æ –∏–º–µ–Ω–∞–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ (`neiromatrius-backend`, `neiromatrius-redis`)
3. **–°–æ–∑–¥–∞–Ω–∏–µ:** Dokploy —Å–æ–∑–¥–∞—Å—Ç —Å–µ—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –¥–µ–ø–ª–æ–µ

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```bash
# 1. Health checks
curl https://api.your-domain.com/health
curl https://api.your-domain.com/api/health/db

# 2. –¢–µ—Å—Ç API
curl -X POST https://api.your-domain.com/api/messages/ \
  -H "Content-Type: application/json" \
  -H "X-Webhook-URL: https://test-webhook.com/test" \
  -H "X-Platform: test" \
  -H "X-Chat-ID: test-123" \
  -d '{"client_id": "test_001", "content": "–ü—Ä–∏–≤–µ—Ç!"}'
```

---

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–í—Å–µ —Ñ–∞–π–ª—ã –≤ –ø–∞–ø–∫–µ `dokploy/`:

- **SUMMARY.md** - –ò—Ç–æ–≥–æ–≤–∞—è —Å–≤–æ–¥–∫–∞
- **DEPLOYMENT_GUIDE.md** - –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ
- **DB_CONNECTION_GUIDE.md** - –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
- **DOKPLOY_ENV_VARIABLES.md** - –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- **REDIS_SETUP.md** - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Redis
- **TESTING_CHECKLIST.md** - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- **FINAL_PRE_DEPLOY_CHECK.md** - –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

---

## ‚úÖ –ò—Ç–æ–≥–æ–≤—ã–π —Å—Ç–∞—Ç—É—Å

**–í—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ–π–¥–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ!**

- ‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ë–î –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è
- ‚úÖ Docker Compose —Ñ–∞–π–ª—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã
- ‚úÖ –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã
- ‚úÖ SQL –º–∏–≥—Ä–∞—Ü–∏–∏ –≥–æ—Ç–æ–≤—ã
- ‚úÖ –°–∫—Ä–∏–ø—Ç—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç–∞—é—Ç
- ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ–ª–Ω–∞—è

**–ü—Ä–æ–µ–∫—Ç –≥–æ—Ç–æ–≤ –∫ –¥–µ–ø–ª–æ—é –Ω–∞ Dokploy!**

---

**–î–∞—Ç–∞:** 8 –¥–µ–∫–∞–±—Ä—è 2025







