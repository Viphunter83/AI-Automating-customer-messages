# ‚úÖ –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º

**–ü—Ä–æ–µ–∫—Ç:** Neiromatrius  
**–î–∞—Ç–∞:** 8 –¥–µ–∫–∞–±—Ä—è 2025

---

## üîç –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏

### 1. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö Supabase

- [ ] **Supabase self-hosted —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç**
- [ ] **–ú–∏–≥—Ä–∞—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã:**
  - –û—Ç–∫—Ä–æ–π—Ç–µ Supabase SQL Editor
  - –í—ã–ø–æ–ª–Ω–∏—Ç–µ `database/migrations_supabase.sql`
  - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ–∑–¥–∞–Ω–∏–µ –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü (9 —Ç–∞–±–ª–∏—Ü)
  - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ–∑–¥–∞–Ω–∏–µ –≤—Å–µ—Ö ENUM —Ç–∏–ø–æ–≤ (6 —Ç–∏–ø–æ–≤)

- [ ] **DATABASE_URL –ø–æ–ª—É—á–µ–Ω –∏ –æ—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω:**
  ```bash
  # –§–æ—Ä–º–∞—Ç –∏–∑ Supabase:
  postgresql://postgres:password@db.xxxxx.supabase.co:5432/postgres
  
  # –§–æ—Ä–º–∞—Ç –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–¥–æ–±–∞–≤–∏—Ç—å +asyncpg):
  postgresql+asyncpg://postgres:password@db.xxxxx.supabase.co:5432/postgres
  ```

- [ ] **–¢–µ—Å—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –ø—Ä–æ–π–¥–µ–Ω:**
  ```bash
  # –õ–æ–∫–∞–ª—å–Ω–æ (–µ—Å–ª–∏ –µ—Å—Ç—å –¥–æ—Å—Ç—É–ø –∫ Supabase):
  export DATABASE_URL="postgresql+asyncpg://..."
  python3 scripts/test_db_connection.py
  ```

### 2. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è Backend

**–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ:**
- [ ] `DATABASE_URL` - —Å—Ç—Ä–æ–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Supabase (—Ñ–æ—Ä–º–∞—Ç: `postgresql+asyncpg://...`)
- [ ] `OPENAI_API_KEY` - –∫–ª—é—á OpenAI API
- [ ] `SECRET_KEY` - —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á (–º–∏–Ω–∏–º—É–º 32 —Å–∏–º–≤–æ–ª–∞)

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ:**
- [ ] `REDIS_URL` - –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Redis
- [ ] `ALLOWED_ORIGINS` - CORS origins (JSON array)

**–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ:**
- [ ] `TELEGRAM_BOT_TOKEN` - –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Telegram
- [ ] `TELEGRAM_ENABLED` - true/false

### 3. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è Frontend

- [ ] `NEXT_PUBLIC_API_URL` - –æ–±—ã—á–Ω–æ `/api`
- [ ] `BACKEND_API_URL` - –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π URL backend (–Ω–∞–ø—Ä–∏–º–µ—Ä: `http://neiromatrius-backend:8000`)

### 4. Docker Compose —Ñ–∞–π–ª—ã

- [ ] `dokploy/docker-compose.backend.yml` - –ø—Ä–æ–≤–µ—Ä–µ–Ω
- [ ] `dokploy/docker-compose.frontend.yml` - –ø—Ä–æ–≤–µ—Ä–µ–Ω
- [ ] `dokploy/docker-compose.redis.yml` - –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Redis
- [ ] –í—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç `${VAR}` —Å–∏–Ω—Ç–∞–∫—Å–∏—Å
- [ ] Health checks –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã

### 5. –§–∞–π–ª—ã –≤ Git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏

- [ ] –í—Å–µ —Ñ–∞–π–ª—ã –∑–∞–∫–æ–º–º–∏—á–µ–Ω—ã
- [ ] `.gitignore` –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- [ ] –ù–µ—Ç —Å–µ–∫—Ä–µ—Ç–æ–≤ –≤ –∫–æ–¥–µ
- [ ] SQL –º–∏–≥—Ä–∞—Ü–∏–∏ –≤ `database/migrations_supabase.sql`

---

## üß™ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏

### –ó–∞–ø—É—Å–∫ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:

```bash
python3 scripts/validate_config.py
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
‚úÖ –í—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ–π–¥–µ–Ω—ã!
   –ü—Ä–æ–µ–∫—Ç –≥–æ—Ç–æ–≤ –∫ –¥–µ–ø–ª–æ—é
```

### –¢–µ—Å—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î (–µ—Å–ª–∏ –µ—Å—Ç—å –¥–æ—Å—Ç—É–ø):

```bash
export DATABASE_URL="postgresql+asyncpg://..."
python3 scripts/test_db_connection.py
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö —É—Å–ø–µ—à–Ω–æ!
‚úÖ –í—Å–µ —Ç–∞–±–ª–∏—Ü—ã —Å–æ–∑–¥–∞–Ω—ã (9 –∏–∑ 9)
‚úÖ –í—Å–µ ENUM —Ç–∏–ø—ã —Å–æ–∑–¥–∞–Ω—ã (6 –∏–∑ 6)
```

---

## üìã –ü–æ—Ä—è–¥–æ–∫ –¥–µ–ø–ª–æ—è

1. **–í—ã–ø–æ–ª–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ –ë–î** (–≤ Supabase SQL Editor)
2. **–°–æ–∑–¥–∞—Ç—å Redis —Å–µ—Ä–≤–∏—Å** (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
3. **–°–æ–∑–¥–∞—Ç—å Backend —Å–µ—Ä–≤–∏—Å**
4. **–°–æ–∑–¥–∞—Ç—å Frontend —Å–µ—Ä–≤–∏—Å**
5. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è**
6. **–ó–∞–¥–µ–ø–ª–æ–∏—Ç—å –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã**
7. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å health checks**

---

## üîß –ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è –ø—Ä–æ–≤–µ—Ä–∫–∏

### 1. Health Checks

```bash
# Backend
curl https://api.your-domain.com/health
# –û–∂–∏–¥–∞–µ—Ç—Å—è: {"status":"healthy","app_name":"Neiromatrius",...}

# Database
curl https://api.your-domain.com/api/health/db
# –û–∂–∏–¥–∞–µ—Ç—Å—è: {"status":"healthy","database":"ok",...}
```

### 2. –¢–µ—Å—Ç API

```bash
curl -X POST https://api.your-domain.com/api/messages/ \
  -H "Content-Type: application/json" \
  -H "X-Webhook-URL: https://test-webhook.com/test" \
  -H "X-Platform: test" \
  -H "X-Chat-ID: test-123" \
  -d '{
    "client_id": "test_client_001",
    "content": "–ü—Ä–∏–≤–µ—Ç! –¢–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ"
  }'
```

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤

–í Dokploy –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:

**Backend –¥–æ–ª–∂–µ–Ω –ø–æ–∫–∞–∑–∞—Ç—å:**
```
‚úÖ Database connection established and responsive
‚úÖ Redis cache connected (–∏–ª–∏ ‚ö†Ô∏è Redis cache unavailable)
üöÄ Starting up application...
```

---

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

### –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î

**–°–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä—è–º–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ PostgreSQL, –∞ –Ω–µ Supabase REST API.**

- ‚úÖ –§–æ—Ä–º–∞—Ç: `postgresql+asyncpg://postgres:password@host:5432/postgres`
- ‚úÖ –ß–µ—Ä–µ–∑ SQLAlchemy ORM
- ‚úÖ –ü—Ä—è–º–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –±—ã—Å—Ç—Ä–µ–µ REST API
- ‚ùå –ù–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Supabase REST API

### Redis

- ‚úÖ –û–ø—Ü–∏–æ–Ω–∞–ª–µ–Ω –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å–∏—Å—Ç–µ–º—ã
- ‚ö†Ô∏è –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è production (–ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤)
- ‚úÖ –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–Ω–µ—à–Ω–∏–π Redis –∏–ª–∏ —Å–µ—Ä–≤–∏—Å –≤ Dokploy

---

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- `DB_CONNECTION_GUIDE.md` - –ü–æ–¥—Ä–æ–±–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—é –∫ –ë–î
- `TESTING_CHECKLIST.md` - –ß–µ–∫–ª–∏—Å—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- `DEPLOYMENT_GUIDE.md` - –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –¥–µ–ø–ª–æ—é
- `DOKPLOY_ENV_VARIABLES.md` - –í—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

---

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 8 –¥–µ–∫–∞–±—Ä—è 2025







